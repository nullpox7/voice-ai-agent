#!/bin/bash

# Voice AI Agent ???????????

echo "? Voice AI Agent ????????"

# ????????????
echo "? ??????????..."
mkdir -p data logs uploads models src static

# .env?????????????.env.example?????
if [ ! -f .env ]; then
    echo "? .env????????..."
    cp .env.example .env
    echo "??  .env?????????API???????????"
else
    echo "? .env????????????"
fi

# Python??????????????????
if command -v python3 &> /dev/null; then
    echo "? Python????????..."
    python3 -m venv venv
    
    echo "? ????????????..."
    if [ -f "venv/bin/activate" ]; then
        source venv/bin/activate
        pip install --upgrade pip
        pip install -r requirements.txt
        echo "? Python????????????"
    else
        echo "??  ??????????????"
    fi
fi

# Docker??????????
if command -v docker &> /dev/null; then
    echo "? Docker???????"
    
    # Docker Compose????
    if command -v docker-compose &> /dev/null; then
        echo "? Docker?????????..."
        docker-compose build
        echo "? Docker?????"
    else
        echo "??  docker-compose????????"
    fi
else
    echo "??  Docker?????????????????????????"
fi

echo ""
echo "? ?????????"
echo ""
echo "????:"
echo "  Docker: docker-compose up -d"
echo "  Python: source venv/bin/activate && uvicorn src.main:app --reload"
echo ""
echo "API URL: http://localhost:8000"
echo "??????: http://localhost:8000/docs"
echo ""
echo "??  ??: .env?????OPENAI_API_KEY?????????"